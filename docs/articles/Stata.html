<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comparison with Stata’s ‘margins’ command • margins</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Comparison with Stata’s ‘margins’ command">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">margins</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.3.25</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction.html">An Introduction to 'margins'</a>
    </li>
    <li>
      <a href="../articles/Stata.html">Comparison with Stata's 'margins' command</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/leeper/margins">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Comparison with Stata’s ‘margins’ command</h1>
            
            <h4 class="date">2018-08-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/leeper/margins/blob/master/vignettes/Stata.Rmd"><code>vignettes/Stata.Rmd</code></a></small>
      <div class="hidden name"><code>Stata.Rmd</code></div>

    </div>

    
    
<p><strong>margins</strong> is intended as a port of (some of) the features of Stata’s <code>margins</code> command. This vignette compares output from Stata’s <code>margins</code> command for linear models against the output of <strong>margins</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"margins"</span>)
<span class="kw">options</span>(<span class="dt">width =</span> <span class="dv">100</span>)</code></pre></div>
<div id="ols-marginal-effects" class="section level2">
<h2 class="hasAnchor">
<a href="#ols-marginal-effects" class="anchor"></a>OLS marginal effects</h2>
<div id="stata" class="section level3">
<h3 class="hasAnchor">
<a href="#stata" class="anchor"></a>Stata</h3>
<pre><code>. quietly reg mpg cyl hp wt
. margins, dydx(*)

Average marginal effects                          Number of obs   =         32
Model VCE    : OLS
Expression   : Linear prediction, predict()
dy/dx w.r.t. : cyl hp wt

------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         cyl |  -.9416166   .5509165    -1.71   0.098    -2.070118    .1868846
          hp |  -.0180381   .0118763    -1.52   0.140    -.0423655    .0062893
          wt |  -3.166973    .740576    -4.28   0.000    -4.683975   -1.649972
------------------------------------------------------------------------------</code></pre>
</div>
<div id="r" class="section level3">
<h3 class="hasAnchor">
<a href="#r" class="anchor"></a>R</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"margins"</span>)
x &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>hp <span class="op">+</span><span class="st"> </span>wt, <span class="dt">data =</span> mtcars)
<span class="kw">summary</span>(<span class="kw"><a href="../reference/margins.html">margins</a></span>(x))</code></pre></div>
<pre><code>##  factor     AME     SE       z      p   lower   upper
##     cyl -0.9416 0.5509 -1.7092 0.0874 -2.0214  0.1382
##      hp -0.0180 0.0119 -1.5188 0.1288 -0.0413  0.0052
##      wt -3.1670 0.7406 -4.2764 0.0000 -4.6185 -1.7155</code></pre>
<hr>
</div>
</div>
<div id="ols-marginal-effects-with-interaction" class="section level2">
<h2 class="hasAnchor">
<a href="#ols-marginal-effects-with-interaction" class="anchor"></a>OLS marginal effects with interaction</h2>
<div id="stata-1" class="section level3">
<h3 class="hasAnchor">
<a href="#stata-1" class="anchor"></a>Stata</h3>
<pre><code>. quietly reg mpg cyl c.hp##c.wt
. margins, dydx(*)

Average marginal effects                          Number of obs   =         32
Model VCE    : OLS
Expression   : Linear prediction, predict()
dy/dx w.r.t. : cyl hp wt

------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         cyl |  -.3652391   .5086204    -0.72   0.479    -1.408842    .6783638
          hp |  -.0252715   .0105097    -2.40   0.023    -.0468357   -.0037073
          wt |  -3.837584   .6730996    -5.70   0.000     -5.21867   -2.456498
------------------------------------------------------------------------------</code></pre>
</div>
<div id="r-1" class="section level3">
<h3 class="hasAnchor">
<a href="#r-1" class="anchor"></a>R</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>hp <span class="op">*</span><span class="st"> </span>wt, <span class="dt">data =</span> mtcars)
<span class="kw">summary</span>(<span class="kw"><a href="../reference/margins.html">margins</a></span>(x))</code></pre></div>
<pre><code>##  factor     AME     SE       z      p   lower   upper
##     cyl -0.3652 0.5086 -0.7181 0.4727 -1.3621  0.6316
##      hp -0.0253 0.0105 -2.4046 0.0162 -0.0459 -0.0047
##      wt -3.8376 0.6731 -5.7013 0.0000 -5.1568 -2.5183</code></pre>
<hr>
</div>
</div>
<div id="ols-marginal-effects-with-factor-term" class="section level2">
<h2 class="hasAnchor">
<a href="#ols-marginal-effects-with-factor-term" class="anchor"></a>OLS marginal effects with factor term</h2>
<div id="stata-2" class="section level3">
<h3 class="hasAnchor">
<a href="#stata-2" class="anchor"></a>Stata</h3>
<pre><code>. quietly reg mpg i.cyl hp wt
. margins, dydx(*)

Average marginal effects                          Number of obs   =         32
Model VCE    : OLS
Expression   : Linear prediction, predict()
dy/dx w.r.t. : 6.cyl 8.cyl hp wt
------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         cyl |
          6  |  -3.359024    1.40167    -2.40   0.024    -6.235014   -.4830353
          8  |  -3.185884   2.170476    -1.47   0.154    -7.639332    1.267564
             |
          hp |  -.0231198   .0119522    -1.93   0.064    -.0476437    .0014041
          wt |  -3.181404   .7196011    -4.42   0.000    -4.657904   -1.704905
------------------------------------------------------------------------------
Note: dy/dx for factor levels is the discrete change from the base level.</code></pre>
</div>
<div id="r-2" class="section level3">
<h3 class="hasAnchor">
<a href="#r-2" class="anchor"></a>R</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(cyl) <span class="op">+</span><span class="st"> </span>hp <span class="op">+</span><span class="st"> </span>wt, <span class="dt">data =</span> mtcars)
<span class="kw">summary</span>(<span class="kw"><a href="../reference/margins.html">margins</a></span>(x))</code></pre></div>
<pre><code>##  factor     AME     SE       z      p   lower   upper
##    cyl6 -3.3590 1.4017 -2.3964 0.0166 -6.1062 -0.6118
##    cyl8 -3.1859 2.1705 -1.4678 0.1422 -7.4399  1.0682
##      hp -0.0231 0.0120 -1.9344 0.0531 -0.0465  0.0003
##      wt -3.1814 0.7196 -4.4211 0.0000 -4.5918 -1.7710</code></pre>
<hr>
</div>
</div>
<div id="ols-marginal-effects-with-squared-term" class="section level2">
<h2 class="hasAnchor">
<a href="#ols-marginal-effects-with-squared-term" class="anchor"></a>OLS marginal effects with squared term</h2>
<div id="stata-3" class="section level3">
<h3 class="hasAnchor">
<a href="#stata-3" class="anchor"></a>Stata</h3>
<pre><code>. quietly reg mpg cyl c.hp##c.hp wt
. margins, dydx(*)

Average marginal effects                          Number of obs   =         32
Model VCE    : OLS
Expression   : Linear prediction, predict()
dy/dx w.r.t. : cyl hp wt
------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         cyl |  -.3696041   .6163571    -0.60   0.554    -1.634264    .8950561
          hp |  -.0429018   .0178353    -2.41   0.023    -.0794969   -.0063066
          wt |  -2.873553   .7301251    -3.94   0.001    -4.371646    -1.37546
------------------------------------------------------------------------------
</code></pre>
</div>
<div id="r-3" class="section level3">
<h3 class="hasAnchor">
<a href="#r-3" class="anchor"></a>R</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>hp <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(hp<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>wt, <span class="dt">data =</span> mtcars)
<span class="kw">summary</span>(<span class="kw"><a href="../reference/margins.html">margins</a></span>(x))</code></pre></div>
<pre><code>##  factor     AME     SE       z      p   lower   upper
##     cyl -0.3696 0.6164 -0.5997 0.5487 -1.5776  0.8384
##      hp -0.0429 0.0178 -2.4054 0.0162 -0.0779 -0.0079
##      wt -2.8736 0.7301 -3.9357 0.0001 -4.3046 -1.4425</code></pre>
<hr>
</div>
</div>
<div id="ols-marginal-effects-with-squared-term-but-no-first-order-term" class="section level2">
<h2 class="hasAnchor">
<a href="#ols-marginal-effects-with-squared-term-but-no-first-order-term" class="anchor"></a>OLS marginal effects with squared term (but no first-order term)</h2>
<div id="stata-4" class="section level3">
<h3 class="hasAnchor">
<a href="#stata-4" class="anchor"></a>Stata</h3>
<pre><code>. gen hp2 = hp^2
. quietly reg mpg cyl hp2 wt
. margins, dydx(*)

Average marginal effects                          Number of obs   =         32
Model VCE    : OLS
Expression   : Linear prediction, predict()
dy/dx w.r.t. : cyl hp2 wt
------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         cyl |   -1.21919   .5030753    -2.42   0.022    -2.249693   -.1886869
         hp2 |   -.000028   .0000276    -1.01   0.320    -.0000846    .0000286
          wt |  -3.218637   .7570747    -4.25   0.000    -4.769435    -1.66784
------------------------------------------------------------------------------</code></pre>
</div>
<div id="r-4" class="section level3">
<h3 class="hasAnchor">
<a href="#r-4" class="anchor"></a>R</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(hp<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>wt, <span class="dt">data =</span> mtcars)
<span class="kw">summary</span>(<span class="kw"><a href="../reference/margins.html">margins</a></span>(x))</code></pre></div>
<pre><code>##  factor     AME     SE       z      p   lower   upper
##     cyl -1.2192 0.5031 -2.4235 0.0154 -2.2052 -0.2332
##      hp -0.0082 0.0081 -1.0124 0.3114 -0.0241  0.0077
##      wt -3.2186 0.7571 -4.2514 0.0000 -4.7025 -1.7348</code></pre>
<hr>
</div>
</div>
<div id="logit-effects-on-log-odds-and-probability-scales" class="section level2">
<h2 class="hasAnchor">
<a href="#logit-effects-on-log-odds-and-probability-scales" class="anchor"></a>Logit effects on log-odds and probability scales</h2>
<div id="stata-5" class="section level3">
<h3 class="hasAnchor">
<a href="#stata-5" class="anchor"></a>Stata</h3>
<pre><code>. quietly logit am cyl hp wt
. margins, dydx(*)

Average marginal effects                          Number of obs   =         32
Model VCE    : OIM
Expression   : Pr(am), predict()
dy/dx w.r.t. : cyl hp wt
------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         cyl |   .0214527   .0469746     0.46   0.648    -.0706157    .1135212
          hp |   .0014339   .0006182     2.32   0.020     .0002224    .0026455
          wt |  -.4025475   .1154098    -3.49   0.000    -.6287466   -.1763484
------------------------------------------------------------------------------

. quietly logit am cyl hp wt
. margins, dydx(*) predict(xb)

Average marginal effects                          Number of obs   =         32
Model VCE    : OIM
Expression   : Linear prediction (log odds), predict(xb)
dy/dx w.r.t. : cyl hp wt
------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         cyl |   .4875978   1.071621     0.46   0.649    -1.612741    2.587936
          hp |   .0325917   .0188611     1.73   0.084    -.0043753    .0695587
          wt |   -9.14947   4.153326    -2.20   0.028    -17.28984   -1.009101
------------------------------------------------------------------------------</code></pre>
</div>
<div id="r-5" class="section level3">
<h3 class="hasAnchor">
<a href="#r-5" class="anchor"></a>R</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">glm</span>(am <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>hp <span class="op">+</span><span class="st"> </span>wt, <span class="dt">data =</span> mtcars, <span class="dt">family =</span> binomial)
<span class="co"># AME</span>
<span class="kw">summary</span>(<span class="kw"><a href="../reference/margins.html">margins</a></span>(x, <span class="dt">type =</span> <span class="st">"response"</span>))</code></pre></div>
<pre><code>##  factor     AME     SE       z      p   lower   upper
##     cyl  0.0215 0.0470  0.4567 0.6479 -0.0706  0.1135
##      hp  0.0014 0.0006  2.3197 0.0204  0.0002  0.0026
##      wt -0.4025 0.1154 -3.4880 0.0005 -0.6287 -0.1764</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># AME and MEM equivalent on "link" scale</span>
<span class="kw">summary</span>(<span class="kw"><a href="../reference/margins.html">margins</a></span>(x, <span class="dt">type =</span> <span class="st">"link"</span>))</code></pre></div>
<pre><code>##  factor     AME     SE       z      p    lower   upper
##     cyl  0.4876 1.0716  0.4550 0.6491  -1.6127  2.5879
##      hp  0.0326 0.0189  1.7280 0.0840  -0.0044  0.0696
##      wt -9.1495 4.1533 -2.2029 0.0276 -17.2898 -1.0091</code></pre>
<hr>
</div>
</div>
<div id="logit-effects-with-factor-variable-on-log-odds-and-probability-scales" class="section level2">
<h2 class="hasAnchor">
<a href="#logit-effects-with-factor-variable-on-log-odds-and-probability-scales" class="anchor"></a>Logit effects with factor variable on log-odds and probability scales</h2>
<div id="stata-6" class="section level3">
<h3 class="hasAnchor">
<a href="#stata-6" class="anchor"></a>Stata</h3>
<pre><code>. quietly logit am i.cyl hp wt
. margins, dydx(*) predict(xb)

Average marginal effects                          Number of obs   =         32
Model VCE    : OIM
Expression   : Linear prediction (log odds), predict(xb)
dy/dx w.r.t. : 6.cyl 8.cyl hp wt
------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         cyl |
          6  |   2.765754   3.156829     0.88   0.381    -3.421517    8.953025
          8  |  -8.388958   13.16745    -0.64   0.524     -34.1967    17.41878
             |
          hp |    .103209   .0960655     1.07   0.283    -.0850759    .2914939
          wt |  -10.67598   5.441998    -1.96   0.050     -21.3421   -.0098575
------------------------------------------------------------------------------
Note: dy/dx for factor levels is the discrete change from the base level.

. margins, dydx(*)

Average marginal effects                          Number of obs   =         32
Model VCE    : OIM
Expression   : Pr(am), predict()
dy/dx w.r.t. : 6.cyl 8.cyl hp wt
------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         cyl |
          6  |   .1197978   .1062873     1.13   0.260    -.0885214    .3281171
          8  |  -.3478575   .2067542    -1.68   0.092    -.7530883    .0573732
             |
          hp |   .0033268   .0029852     1.11   0.265    -.0025241    .0091777
          wt |  -.3441297   .1188604    -2.90   0.004    -.5770919   -.1111675
------------------------------------------------------------------------------
Note: dy/dx for factor levels is the discrete change from the base level.</code></pre>
</div>
<div id="r-6" class="section level3">
<h3 class="hasAnchor">
<a href="#r-6" class="anchor"></a>R</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">glm</span>(am <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(cyl) <span class="op">+</span><span class="st"> </span>hp <span class="op">+</span><span class="st"> </span>wt, <span class="dt">data =</span> mtcars, <span class="dt">family =</span> binomial)
<span class="co"># Log-odds</span>
<span class="kw">summary</span>(<span class="kw"><a href="../reference/margins.html">margins</a></span>(x, <span class="dt">type =</span> <span class="st">"link"</span>))</code></pre></div>
<pre><code>##  factor      AME      SE       z      p    lower   upper
##    cyl6   2.7658  3.1568  0.8761 0.3810  -3.4214  8.9529
##    cyl8  -8.3890 13.1671 -0.6371 0.5240 -34.1960 17.4181
##      hp   0.1032  0.0961  1.0744 0.2826  -0.0851  0.2915
##      wt -10.6760  5.4418 -1.9618 0.0498 -21.3417 -0.0102</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Probability with continuous factors</span>
<span class="kw">summary</span>(<span class="kw"><a href="../reference/margins.html">margins</a></span>(x, <span class="dt">type =</span> <span class="st">"response"</span>))</code></pre></div>
<pre><code>##  factor     AME     SE       z      p   lower   upper
##    cyl6  0.1198 0.1063  1.1271 0.2597 -0.0885  0.3281
##    cyl8 -0.3479 0.2068 -1.6825 0.0925 -0.7531  0.0574
##      hp  0.0033 0.0030  1.1144 0.2651 -0.0025  0.0092
##      wt -0.3441 0.1189 -2.8953 0.0038 -0.5771 -0.1112</code></pre>
<hr>
</div>
</div>
<div id="logit-with-interaction-on-probability-and-log-odds-scales" class="section level2">
<h2 class="hasAnchor">
<a href="#logit-with-interaction-on-probability-and-log-odds-scales" class="anchor"></a>Logit with interaction on probability and Log-Odds scales</h2>
<div id="stata-7" class="section level3">
<h3 class="hasAnchor">
<a href="#stata-7" class="anchor"></a>Stata</h3>
<pre><code>. quietly logit am cyl c.hp##c.wt
. margins, dydx(*)

Average marginal effects                          Number of obs   =         32
Model VCE    : OIM
Expression   : Pr(am), predict()
dy/dx w.r.t. : cyl hp wt
------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         cyl |   .0215633   .0492676     0.44   0.662    -.0749994    .1181261
          hp |   .0026673   .0023004     1.16   0.246    -.0018414     .007176
          wt |  -.5157922   .2685806    -1.92   0.055    -1.042201    .0106162
------------------------------------------------------------------------------

. margins, dydx(*) predict(xb)

Average marginal effects                          Number of obs   =         32
Model VCE    : OIM
Expression   : Linear prediction (log odds), predict(xb)
dy/dx w.r.t. : cyl hp wt
------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         cyl |   .5156396   1.169458     0.44   0.659    -1.776456    2.807735
          hp |   .0515116    .035699     1.44   0.149    -.0184571    .1214804
          wt |  -12.24264   7.678428    -1.59   0.111    -27.29208    2.806807
------------------------------------------------------------------------------</code></pre>
</div>
<div id="r-7" class="section level3">
<h3 class="hasAnchor">
<a href="#r-7" class="anchor"></a>R</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">glm</span>(am <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>hp <span class="op">*</span><span class="st"> </span>wt, <span class="dt">data =</span> mtcars, <span class="dt">family =</span> binomial)</code></pre></div>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># AME</span>
<span class="kw">summary</span>(<span class="kw"><a href="../reference/margins.html">margins</a></span>(x, <span class="dt">type =</span> <span class="st">"response"</span>))</code></pre></div>
<pre><code>##  factor     AME     SE       z      p   lower  upper
##     cyl  0.0216 0.0493  0.4377 0.6616 -0.0750 0.1181
##      hp  0.0027 0.0023  1.1596 0.2462 -0.0018 0.0072
##      wt -0.5158 0.2685 -1.9209 0.0547 -1.0421 0.0105</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># AME and MEM equivalent on "link" scale</span>
<span class="kw">summary</span>(<span class="kw"><a href="../reference/margins.html">margins</a></span>(x, <span class="dt">type =</span> <span class="st">"link"</span>))</code></pre></div>
<pre><code>##  factor      AME     SE       z      p    lower  upper
##     cyl   0.5156 1.1695  0.4409 0.6593  -1.7765 2.8077
##      hp   0.0515 0.0357  1.4430 0.1490  -0.0185 0.1215
##      wt -12.2426 7.6784 -1.5944 0.1108 -27.2920 2.8067</code></pre>
</div>
</div>
<div id="probit-effects-on-latent-and-probability-scales" class="section level2">
<h2 class="hasAnchor">
<a href="#probit-effects-on-latent-and-probability-scales" class="anchor"></a>Probit effects on latent and probability scales</h2>
<div id="stata-8" class="section level3">
<h3 class="hasAnchor">
<a href="#stata-8" class="anchor"></a>Stata</h3>
<pre><code>. quietly probit am cyl c.hp##c.wt
. margins, dydx(*) predict(xb)

Average marginal effects                          Number of obs   =         32
Model VCE    : OIM
Expression   : Linear prediction, predict(xb)
dy/dx w.r.t. : cyl hp wt
------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         cyl |   .2974758   .6629205     0.45   0.654    -1.001825    1.596776
          hp |   .0277713   .0193121     1.44   0.150    -.0100797    .0656223
          wt |  -6.626949   4.096208    -1.62   0.106    -14.65537    1.401471
------------------------------------------------------------------------------

. margins, dydx(*)

Average marginal effects                          Number of obs   =         32
Model VCE    : OIM
Expression   : Pr(am), predict()
dy/dx w.r.t. : cyl hp wt
------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         cyl |    .022611   .0498253     0.45   0.650    -.0750447    .1202667
          hp |   .0025769   .0022607     1.14   0.254     -.001854    .0070077
          wt |   -.508829   .2625404    -1.94   0.053    -1.023399    .0057408
------------------------------------------------------------------------------</code></pre>
</div>
<div id="r-8" class="section level3">
<h3 class="hasAnchor">
<a href="#r-8" class="anchor"></a>R</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">glm</span>(am <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>hp <span class="op">*</span><span class="st"> </span>wt, <span class="dt">data =</span> mtcars, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link=</span><span class="st">"probit"</span>))</code></pre></div>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># AME (log-odds)</span>
<span class="kw">summary</span>(<span class="kw"><a href="../reference/margins.html">margins</a></span>(x, <span class="dt">type =</span> <span class="st">"link"</span>))</code></pre></div>
<pre><code>##  factor     AME     SE       z      p    lower  upper
##     cyl  0.2975 0.6472  0.4596 0.6458  -0.9710 1.5660
##      hp  0.0278 0.0184  1.5075 0.1317  -0.0083 0.0639
##      wt -6.6269 3.9095 -1.6951 0.0901 -14.2894 1.0355</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># AME (probability)</span>
<span class="kw">summary</span>(<span class="kw"><a href="../reference/margins.html">margins</a></span>(x, <span class="dt">type =</span> <span class="st">"response"</span>))</code></pre></div>
<pre><code>##  factor     AME     SE       z      p   lower   upper
##     cyl  0.0226 0.0492  0.4598 0.6456 -0.0738  0.1190
##      hp  0.0026 0.0021  1.2244 0.2208 -0.0015  0.0067
##      wt -0.5088 0.2479 -2.0523 0.0401 -0.9948 -0.0229</code></pre>
</div>
</div>
<div id="poisson-effects-on-latent-and-probability-scales" class="section level2">
<h2 class="hasAnchor">
<a href="#poisson-effects-on-latent-and-probability-scales" class="anchor"></a>Poisson effects on latent and probability scales</h2>
<div id="stata-9" class="section level3">
<h3 class="hasAnchor">
<a href="#stata-9" class="anchor"></a>Stata</h3>
<pre><code>. quietly poisson carb cyl c.hp##c.wt
. margins, dydx(*) predict(xb)

Average marginal effects                          Number of obs   =         32
Model VCE    : OIM
Expression   : Linear prediction, predict(xb)
dy/dx w.r.t. : cyl hp wt
------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         cyl |  -.0993854   .1478936    -0.67   0.502    -.3892516    .1904808
          hp |   .0066519   .0024217     2.75   0.006     .0019054    .0113984
          wt |   .1225051   .2035185     0.60   0.547    -.2763837     .521394
------------------------------------------------------------------------------

. margins, dydx(*)

Average marginal effects                          Number of obs   =         32
Model VCE    : OIM
Expression   : Predicted number of events, predict()
dy/dx w.r.t. : cyl hp wt
------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         cyl |  -.2795214   .4169931    -0.67   0.503    -1.096813      .53777
          hp |   .0175935   .0067179     2.62   0.009     .0044267    .0307604
          wt |   .2075447   .4859868     0.43   0.669    -.7449719    1.160061
------------------------------------------------------------------------------</code></pre>
</div>
<div id="r-9" class="section level3">
<h3 class="hasAnchor">
<a href="#r-9" class="anchor"></a>R</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">glm</span>(carb <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>hp <span class="op">*</span><span class="st"> </span>wt, <span class="dt">data =</span> mtcars, <span class="dt">family =</span> poisson)
<span class="co"># AME (linear/link)</span>
<span class="kw">summary</span>(<span class="kw"><a href="../reference/margins.html">margins</a></span>(x, <span class="dt">type =</span> <span class="st">"link"</span>))</code></pre></div>
<pre><code>##  factor     AME     SE       z      p   lower  upper
##     cyl -0.0994 0.1479 -0.6720 0.5016 -0.3893 0.1905
##      hp  0.0067 0.0024  2.7468 0.0060  0.0019 0.0114
##      wt  0.1225 0.2035  0.6019 0.5472 -0.2764 0.5214</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># AME (probability)</span>
<span class="kw">summary</span>(<span class="kw"><a href="../reference/margins.html">margins</a></span>(x, <span class="dt">type =</span> <span class="st">"response"</span>))</code></pre></div>
<pre><code>##  factor     AME     SE       z      p   lower  upper
##     cyl -0.2795 0.4170 -0.6703 0.5026 -1.0968 0.5378
##      hp  0.0176 0.0067  2.6189 0.0088  0.0044 0.0308
##      wt  0.2075 0.4860  0.4271 0.6693 -0.7449 1.1600</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#ols-marginal-effects">OLS marginal effects</a></li>
      <li><a href="#ols-marginal-effects-with-interaction">OLS marginal effects with interaction</a></li>
      <li><a href="#ols-marginal-effects-with-factor-term">OLS marginal effects with factor term</a></li>
      <li><a href="#ols-marginal-effects-with-squared-term">OLS marginal effects with squared term</a></li>
      <li><a href="#ols-marginal-effects-with-squared-term-but-no-first-order-term">OLS marginal effects with squared term (but no first-order term)</a></li>
      <li><a href="#logit-effects-on-log-odds-and-probability-scales">Logit effects on log-odds and probability scales</a></li>
      <li><a href="#logit-effects-with-factor-variable-on-log-odds-and-probability-scales">Logit effects with factor variable on log-odds and probability scales</a></li>
      <li><a href="#logit-with-interaction-on-probability-and-log-odds-scales">Logit with interaction on probability and Log-Odds scales</a></li>
      <li><a href="#probit-effects-on-latent-and-probability-scales">Probit effects on latent and probability scales</a></li>
      <li><a href="#poisson-effects-on-latent-and-probability-scales">Poisson effects on latent and probability scales</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Thomas J. Leeper.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
